{"version":3,"sources":["../src/lib/errors.ts","../src/lib/openai.ts","../src/lib/livekit.ts","../src/lib/actions.ts","../src/lib/storage.ts","../src/components/ChatInterface.tsx","../src/components/VoiceInterface.tsx","../src/components/AlertPanel.tsx","../src/components/NoSSR.tsx","../src/components/ErrorBoundary.tsx","../src/lib/browser-compatibility.ts","../src/lib/dynamic-imports.ts","../src/JodexAI.tsx"],"names":["Room","useState","useRef","useEffect","jsxs","jsx","AnimatePresence","motion","useCallback","Fragment","Component","create","error"],"mappings":"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","file":"index.js","sourcesContent":["import { JodexError as JodexErrorType } from '../types';\n\nexport class JodexError extends Error {\n  code: string;\n  type: 'api' | 'voice' | 'network' | 'validation' | 'unknown';\n  details?: any;\n\n  constructor(message: string, type: JodexErrorType['type'] = 'unknown', code?: string) {\n    super(message);\n    this.name = 'JodexError';\n    this.type = type;\n    this.code = code || 'UNKNOWN_ERROR';\n  }\n}","import { Message, Action, Datasets } from '../types';\nimport { JodexError } from './errors';\n\nexport interface ChatCompletionOptions {\n  apiUrl?: string; // API proxy URL for secure calls\n  apiKey?: string; // Only needed for direct API calls (not recommended)\n  systemPrompt?: string;\n  instructions?: string;\n  datasets?: Datasets;\n  model?: string;\n  temperature?: number;\n  maxTokens?: number;\n  streaming?: boolean;\n}\n\nexport interface ChatCompletionResult {\n  content: string;\n  actions?: Action[];\n  usage?: {\n    promptTokens: number;\n    completionTokens: number;\n    totalTokens: number;\n  };\n}\n\nexport class OpenAIClient {\n  private options: ChatCompletionOptions;\n\n  constructor(options: ChatCompletionOptions) {\n    if (!options.apiUrl && !options.apiKey) {\n      throw new JodexError(\n        'Either apiUrl (recommended for security) or apiKey is required',\n        'validation',\n        'MISSING_API_CONFIG'\n      );\n    }\n\n    if (options.apiKey) {\n      console.warn(\n        'Using API key directly is not recommended. Consider using an API proxy route for better security.'\n      );\n    }\n\n    this.options = {\n      model: 'gpt-4-turbo-preview',\n      temperature: 0.7,\n      maxTokens: 2000,\n      streaming: true,\n      ...options,\n    };\n  }\n\n  /**\n   * Generate a chat completion with streaming support\n   */\n  async *streamChatCompletion(messages: Message[]): AsyncGenerator<ChatCompletionResult, void, unknown> {\n    try {\n      const systemContent = this.buildSystemPrompt();\n      const openaiMessages = this.formatMessages(messages, systemContent);\n\n      if (this.options.apiUrl) {\n        // Use API proxy for secure calls\n        yield* this.streamViaProxy(openaiMessages);\n      } else {\n        // Fallback to direct OpenAI client (not recommended)\n        yield* this.streamViaDirectAPI(openaiMessages);\n      }\n    } catch (error) {\n      const jodexError = this.handleError(error);\n      throw jodexError;\n    }\n  }\n\n  /**\n   * Stream via API proxy (secure method)\n   */\n  private async *streamViaProxy(\n    openaiMessages: any[]\n  ): AsyncGenerator<ChatCompletionResult, void, unknown> {\n    const response = await fetch(`${this.options.apiUrl}/stream`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        messages: openaiMessages,\n        model: this.options.model,\n        temperature: this.options.temperature,\n        maxTokens: this.options.maxTokens,\n      }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      throw new JodexError(\n        errorData.error || 'API request failed',\n        'api',\n        'PROXY_ERROR'\n      );\n    }\n\n    const reader = response.body?.getReader();\n    if (!reader) {\n      throw new JodexError('No response body', 'api', 'NO_RESPONSE_BODY');\n    }\n\n    const decoder = new TextDecoder();\n    let buffer = '';\n\n    try {\n      while (true) {\n        const { done, value } = await reader.read();\n        if (done) break;\n\n        buffer += decoder.decode(value, { stream: true });\n        const lines = buffer.split('\\n');\n        buffer = lines.pop() || '';\n\n        for (const line of lines) {\n          if (line.startsWith('data: ')) {\n            const data = line.slice(6);\n            if (data === '[DONE]') return;\n\n            try {\n              const parsed = JSON.parse(data);\n\n              if (parsed.error) {\n                throw new JodexError(parsed.error, 'api', 'PROXY_ERROR');\n              }\n\n              if (parsed.done) {\n                const actions = this.extractActions(parsed.content || '');\n                yield {\n                  content: parsed.content || '',\n                  actions,\n                };\n                return;\n              }\n\n              if (parsed.content) {\n                yield { content: parsed.content };\n              }\n            } catch (parseError) {\n              console.warn('Failed to parse SSE data:', data);\n            }\n          }\n        }\n      }\n    } finally {\n      reader.releaseLock();\n    }\n  }\n\n  /**\n   * Stream via direct OpenAI API (fallback method - not secure)\n   */\n  private async *streamViaDirectAPI(\n    openaiMessages: any[]\n  ): AsyncGenerator<ChatCompletionResult, void, unknown> {\n    // Dynamic import to avoid bundling issues\n    const { default: OpenAI } = await import('openai');\n\n    const client = new OpenAI({\n      apiKey: this.options.apiKey,\n      dangerouslyAllowBrowser: true,\n    });\n\n    const stream = await client.chat.completions.create({\n      model: this.options.model!,\n      messages: openaiMessages,\n      temperature: this.options.temperature,\n      max_tokens: this.options.maxTokens,\n      stream: true,\n    });\n\n    let content = '';\n\n    for await (const chunk of stream) {\n      const delta = chunk.choices[0]?.delta;\n\n      if (delta.content) {\n        content += delta.content;\n        yield { content };\n      }\n\n      // Check for complete message\n      if (chunk.choices[0]?.finish_reason === 'stop') {\n        const actions = this.extractActions(content);\n        yield {\n          content,\n          actions,\n          usage: chunk.usage ? {\n            promptTokens: chunk.usage.prompt_tokens || 0,\n            completionTokens: chunk.usage.completion_tokens || 0,\n            totalTokens: chunk.usage.total_tokens || 0,\n          } : undefined,\n        };\n      }\n    }\n  }\n\n  /**\n   * Generate a single chat completion (non-streaming)\n   */\n  async chatCompletion(messages: Message[]): Promise<ChatCompletionResult> {\n    try {\n      const systemContent = this.buildSystemPrompt();\n      const openaiMessages = this.formatMessages(messages, systemContent);\n\n      if (this.options.apiUrl) {\n        // Use API proxy for secure calls\n        return await this.completionViaProxy(openaiMessages);\n      } else {\n        // Fallback to direct OpenAI client (not recommended)\n        return await this.completionViaDirectAPI(openaiMessages);\n      }\n    } catch (error) {\n      const jodexError = this.handleError(error);\n      throw jodexError;\n    }\n  }\n\n  /**\n   * Get completion via API proxy (secure method)\n   */\n  private async completionViaProxy(\n    openaiMessages: any[]\n  ): Promise<ChatCompletionResult> {\n    const response = await fetch(this.options.apiUrl!, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        messages: openaiMessages,\n        model: this.options.model,\n        temperature: this.options.temperature,\n        maxTokens: this.options.maxTokens,\n      }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      throw new JodexError(\n        errorData.error || 'API request failed',\n        'api',\n        'PROXY_ERROR'\n      );\n    }\n\n    const data = await response.json();\n    const content = data.content || '';\n    const actions = this.extractActions(content);\n\n    return {\n      content,\n      actions,\n    };\n  }\n\n  /**\n   * Get completion via direct OpenAI API (fallback method - not secure)\n   */\n  private async completionViaDirectAPI(\n    openaiMessages: any[]\n  ): Promise<ChatCompletionResult> {\n    // Dynamic import to avoid bundling issues\n    const { default: OpenAI } = await import('openai');\n\n    const client = new OpenAI({\n      apiKey: this.options.apiKey,\n      dangerouslyAllowBrowser: true,\n    });\n\n    const response = await client.chat.completions.create({\n      model: this.options.model!,\n      messages: openaiMessages,\n      temperature: this.options.temperature,\n      max_tokens: this.options.maxTokens,\n      stream: false,\n    });\n\n    const content = response.choices[0]?.message?.content || '';\n    const actions = this.extractActions(content);\n\n    return {\n      content,\n      actions,\n      usage: response.usage ? {\n        promptTokens: response.usage.prompt_tokens || 0,\n        completionTokens: response.usage.completion_tokens || 0,\n        totalTokens: response.usage.total_tokens || 0,\n      } : undefined,\n    };\n  }\n\n  /**\n   * Build the system prompt with context and datasets\n   */\n  private buildSystemPrompt(): string {\n    const parts: string[] = [];\n\n    // Add base system prompt\n    if (this.options.systemPrompt) {\n      parts.push(this.options.systemPrompt);\n    } else {\n      parts.push(this.getDefaultSystemPrompt());\n    }\n\n    // Add additional instructions\n    if (this.options.instructions) {\n      parts.push(`\\nAdditional Instructions:\\n${this.options.instructions}`);\n    }\n\n    // Add datasets context\n    if (this.options.datasets) {\n      parts.push(this.buildDatasetContext(this.options.datasets));\n    }\n\n    return parts.join('\\n\\n');\n  }\n\n  /**\n   * Get the default system prompt for Jodex AI Assistant\n   */\n  private getDefaultSystemPrompt(): string {\n    return `You are Jodex, an AI assistant specializing in agricultural supply chain management for cacao farming operations.\n\nYour role is to help farmers, processors, and agricultural cooperatives make informed decisions by analyzing data about farmers, weather conditions, harvest records, disease patterns, and inventory levels.\n\nKey capabilities:\n- Analyze farmer data and production trends\n- Provide weather-based insights and alerts\n- Identify disease risk factors based on weather patterns\n- Help with inventory management and supply forecasting\n- Suggest optimal actions based on data analysis\n\nWhen responding:\n1. Be helpful, proactive, and practical\n2. Base your recommendations on the provided data\n3. Suggest specific, actionable steps\n4. Alert users to potential problems or opportunities\n5. Keep responses concise but comprehensive\n\nYou can trigger UI actions using this format:\n\\`\\`\\`action\n{\n  \"type\": \"action_type\",\n  \"data\": { ... },\n  \"priority\": \"high|medium|low\"\n}\n\\`\\`\\`\n\nAvailable action types:\n- show_supply_forecast: Show supply predictions\n- show_farmer_list: Display farmer information\n- show_weather_alerts: Show weather-based alerts\n- show_disease_map: Display disease risk information\n- show_inventory: Show current inventory levels\n- open_farmer_profile: Show specific farmer details\n- send_notification: Send a notification message`;\n  }\n\n  /**\n   * Build dataset context for the AI\n   */\n  private buildDatasetContext(datasets: Datasets): string {\n    const contextParts: string[] = [];\n    contextParts.push('Available Data:');\n\n    if (datasets.farmers && datasets.farmers.length > 0) {\n      contextParts.push(`- Farmers: ${datasets.farmers.length} profiles with production data`);\n    }\n\n    if (datasets.harvests && datasets.harvests.length > 0) {\n      contextParts.push(`- Harvest Records: ${datasets.harvests.length} historical records`);\n    }\n\n    if (datasets.weather && datasets.weather.length > 0) {\n      contextParts.push(`- Weather Data: ${datasets.weather.length} days of data`);\n    }\n\n    if (datasets.diseases && datasets.diseases.length > 0) {\n      contextParts.push(`- Disease Database: ${datasets.diseases.length} disease/pest entries`);\n    }\n\n    if (datasets.inventory) {\n      contextParts.push(`- Inventory: Current stock levels and usage rates`);\n    }\n\n    // Add custom datasets\n    Object.keys(datasets).forEach(key => {\n      if (!['farmers', 'harvests', 'weather', 'diseases', 'inventory'].includes(key)) {\n        const data = datasets[key];\n        if (Array.isArray(data)) {\n          contextParts.push(`- ${key}: ${data.length} entries`);\n        } else {\n          contextParts.push(`- ${key}: Available data`);\n        }\n      }\n    });\n\n    return contextParts.join('\\n');\n  }\n\n  /**\n   * Format messages for OpenAI API\n   */\n  private formatMessages(messages: Message[], systemContent: string): any[] {\n    const openaiMessages: any[] = [\n      {\n        role: 'system',\n        content: systemContent,\n      },\n    ];\n\n    // Add user messages only (skip assistant messages to avoid confusion)\n    messages\n      .filter(msg => msg.role === 'user')\n      .forEach(msg => {\n        openaiMessages.push({\n          role: 'user',\n          content: msg.content,\n        });\n      });\n\n    return openaiMessages;\n  }\n\n  /**\n   * Extract actions from AI response\n   */\n  private extractActions(content: string): Action[] {\n    const actions: Action[] = [];\n    const actionRegex = /```action\\s*([\\s\\S]*?)```/g;\n\n    let match;\n    while ((match = actionRegex.exec(content)) !== null) {\n      try {\n        const actionData = JSON.parse(match[1].trim());\n        actions.push({\n          type: actionData.type || 'custom',\n          data: actionData.data || {},\n          priority: actionData.priority || 'medium',\n          timestamp: new Date().toISOString(),\n        });\n      } catch (error) {\n        console.warn('Failed to parse action:', match[1]);\n      }\n    }\n\n    return actions;\n  }\n\n  /**\n   * Handle API errors and convert to JodexError\n   */\n  private handleError(error: any): JodexError {\n    if (error instanceof JodexError) {\n      return error;\n    }\n\n    if (error.status === 401) {\n      return new JodexError('Invalid OpenAI API key', 'api', 'INVALID_API_KEY');\n    }\n\n    if (error.status === 429) {\n      return new JodexError('Rate limit exceeded. Please try again later.', 'api', 'RATE_LIMIT');\n    }\n\n    if (error.status >= 500) {\n      return new JodexError('OpenAI service temporarily unavailable', 'api', 'SERVICE_UNAVAILABLE');\n    }\n\n    const jodexError = new JodexError(error.message || 'Unknown error occurred', 'api', 'UNKNOWN_ERROR');\n    jodexError.details = error;\n    return jodexError;\n  }\n\n  /**\n   * Update configuration\n   */\n  updateOptions(options: Partial<ChatCompletionOptions>): void {\n    this.options = { ...this.options, ...options };\n\n    if (options.apiKey) {\n      console.warn(\n        'Using API key directly is not recommended. Consider using an API proxy route for better security.'\n      );\n    }\n  }\n\n  /**\n   * Get current configuration\n   */\n  getOptions(): ChatCompletionOptions {\n    return { ...this.options };\n  }\n}","import { Room, AudioTrack, LocalAudioTrack, RemoteParticipant } from 'livekit-client';\nimport { VoiceState, VoiceSettings } from '../types';\nimport { JodexError } from './errors';\n\nexport interface VoiceConnectionOptions {\n  url: string;\n  token?: string; // Optional when using server-side token generation\n  roomName?: string; // Required for server-side token generation\n  participantName?: string; // Required for server-side token generation\n  participantIdentity?: string; // Optional, will be generated\n  useServerToken?: boolean; // Enable server-side token generation\n  settings?: Partial<VoiceSettings>;\n}\n\nexport class VoiceConnection {\n  private room: Room | null = null;\n  private localAudioTrack: LocalAudioTrack | null = null;\n  private remoteAudioTrack: AudioTrack | null = null;\n  private mediaStream: MediaStream | null = null;\n  private audioContext: AudioContext | null = null;\n  private analyser: AnalyserNode | null = null;\n  private isDestroyed = false;\n  private tokenRefreshInterval: NodeJS.Timeout | null = null;\n  private volumeAnimationFrame: number | null = null;\n  private options: VoiceConnectionOptions;\n  private currentRoomName: string = '';\n  private currentParticipantName: string = '';\n\n  private state: VoiceState = {\n    isRecording: false,\n    isPlaying: false,\n    isListening: false,\n    transcript: '',\n    volume: 0,\n    isConnected: false,\n    error: undefined,\n  };\n\n  private settings: VoiceSettings = {\n    enabled: true,\n    autoPlay: true,\n    language: 'en-US',\n    voice: 'default',\n    rate: 1.0,\n    pitch: 1.0,\n  };\n\n  private onStateChangeCallbacks: ((state: VoiceState) => void)[] = [];\n  private onTranscriptCallbacks: ((transcript: string) => void)[] = [];\n  private onErrorCallbacks: ((error: JodexError) => void)[] = [];\n\n  constructor(options: VoiceConnectionOptions) {\n    this.options = options;\n    this.settings = { ...this.settings, ...options.settings };\n\n    if (options.useServerToken) {\n      this.initializeConnectionWithServerToken();\n    } else {\n      if (!options.token) {\n        throw new JodexError('Token is required when not using server-side token generation', 'voice', 'MISSING_TOKEN');\n      }\n      this.initializeConnection(options.url, options.token);\n    }\n  }\n\n  /**\n   * Initialize LiveKit connection\n   */\n  private async initializeConnection(url: string, token: string): Promise<void> {\n    try {\n      this.room = new Room({\n        adaptiveStream: true,\n        dynacast: true,\n        audioCaptureDefaults: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n        },\n      });\n\n      // Set up event listeners\n      this.setupEventListeners();\n\n      // Connect to room\n      await this.room.connect(url, token);\n      this.updateState({ isConnected: true });\n\n    } catch (error) {\n      const jodexError = this.handleError(error);\n      this.updateState({ error: jodexError.message });\n      this.onErrorCallbacks.forEach(cb => cb(jodexError));\n    }\n  }\n\n  /**\n   * Initialize connection with server-side token generation\n   */\n  private async initializeConnectionWithServerToken(): Promise<void> {\n    try {\n      // Store room and participant names for token refresh\n      this.currentRoomName = this.options.roomName || 'jodex-ai-room';\n      this.currentParticipantName = this.options.participantName || 'Jodex AI User';\n\n      // Generate token from server\n      const token = await this.generateToken({\n        roomName: this.currentRoomName,\n        participantName: this.currentParticipantName,\n        participantIdentity: this.options.participantIdentity,\n      });\n\n      this.room = new Room({\n        adaptiveStream: true,\n        dynacast: true,\n        audioCaptureDefaults: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n        },\n      });\n\n      this.setupEventListeners();\n      this.setupTokenRefresh();\n\n      await this.room.connect(this.options.url, token);\n      this.updateState({ isConnected: true });\n\n    } catch (error) {\n      const jodexError = this.handleError(error);\n      this.updateState({ error: jodexError.message });\n      this.onErrorCallbacks.forEach(cb => cb(jodexError));\n    }\n  }\n\n  /**\n   * Generate token from server\n   */\n  private async generateToken(params: {\n    roomName: string;\n    participantName: string;\n    participantIdentity?: string;\n  }): Promise<string> {\n    const response = await fetch('/api/livekit/token', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(params),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      throw new JodexError(\n        errorData.error || 'Failed to generate token',\n        'voice',\n        'TOKEN_GENERATION_FAILED'\n      );\n    }\n\n    const data = await response.json();\n    return data.token;\n  }\n\n  /**\n   * Set up token refresh for long-lived sessions\n   */\n  private setupTokenRefresh(): void {\n    // Clear any existing interval\n    if (this.tokenRefreshInterval) {\n      clearInterval(this.tokenRefreshInterval);\n    }\n\n    // Refresh token 5 minutes before expiry\n    this.tokenRefreshInterval = setInterval(async () => {\n      try {\n        if (!this.room || !this.options.useServerToken) {\n          return;\n        }\n\n        const newToken = await this.generateToken({\n          roomName: this.currentRoomName,\n          participantName: this.currentParticipantName,\n          participantIdentity: this.options.participantIdentity,\n        });\n\n        // Note: LiveKit doesn't have a direct method to update token mid-session\n        // This would typically require reconnection, but for most use cases,\n        // the 1-hour token expiry is sufficient\n        console.log('Token refresh completed (reconnection may be required for long sessions)');\n\n      } catch (error) {\n        console.error('Token refresh failed:', error);\n        // Handle token refresh failure gracefully\n      }\n    }, 3000000); // 50 minutes\n  }\n\n  /**\n   * Set up LiveKit room event listeners\n   */\n  private setupEventListeners(): void {\n    if (!this.room) return;\n\n    this.room.on('connected', () => {\n      this.updateState({ isConnected: true });\n    });\n\n    this.room.on('disconnected', () => {\n      this.updateState({\n        isConnected: false,\n        isRecording: false,\n        isPlaying: false,\n        isListening: false\n      });\n    });\n\n    this.room.on('participantConnected', (participant: RemoteParticipant) => {\n      console.log('Participant connected:', participant.identity);\n    });\n\n    this.room.on('trackSubscribed', (track, publication, participant) => {\n      if (track.kind === 'audio') {\n        this.remoteAudioTrack = track as AudioTrack;\n        track.attach();\n      }\n    });\n\n    this.room.on('trackUnsubscribed', (track, publication, participant) => {\n      if (track.kind === 'audio') {\n        track.detach();\n        if (this.remoteAudioTrack === track) {\n          this.remoteAudioTrack = null;\n        }\n      }\n    });\n  }\n\n  /**\n   * Start voice recording\n   */\n  async startRecording(): Promise<void> {\n    if (this.state.isRecording || !this.settings.enabled) {\n      return;\n    }\n\n    try {\n      // Get microphone access\n      this.mediaStream = await navigator.mediaDevices.getUserMedia({\n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n        },\n        video: false,\n      });\n\n      // Create audio context for analysis\n      this.audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n      this.analyser = this.audioContext.createAnalyser();\n      this.analyser.fftSize = 256;\n\n      const source = this.audioContext.createMediaStreamSource(this.mediaStream);\n      source.connect(this.analyser);\n\n      // Start monitoring volume\n      this.startVolumeMonitoring();\n\n      // Publish audio track to LiveKit room\n      if (this.room) {\n        const publication = await this.room.localParticipant.publishTrack(this.mediaStream.getAudioTracks()[0], {\n          name: 'microphone',\n        });\n        this.localAudioTrack = publication.track as LocalAudioTrack;\n      }\n\n      this.updateState({\n        isRecording: true,\n        isListening: true,\n        transcript: ''\n      });\n\n      // Start speech recognition\n      this.startSpeechRecognition();\n\n    } catch (error) {\n      const jodexError = this.handleError(error);\n      this.updateState({ error: jodexError.message });\n      this.onErrorCallbacks.forEach(cb => cb(jodexError));\n    }\n  }\n\n  /**\n   * Stop voice recording\n   */\n  async stopRecording(): Promise<void> {\n    if (!this.state.isRecording) {\n      return;\n    }\n\n    try {\n      // Stop volume monitoring first\n      this.stopVolumeMonitoring();\n\n      // Stop media stream\n      if (this.mediaStream) {\n        this.mediaStream.getTracks().forEach(track => track.stop());\n        this.mediaStream = null;\n      }\n\n      // Unpublish audio track\n      if (this.localAudioTrack && this.room) {\n        await this.room.localParticipant.unpublishTrack(this.localAudioTrack);\n        this.localAudioTrack = null;\n      }\n\n      // Close audio context\n      if (this.audioContext) {\n        await this.audioContext.close();\n        this.audioContext = null;\n        this.analyser = null;\n      }\n\n      // Stop speech recognition\n      this.stopSpeechRecognition();\n\n      this.updateState({\n        isRecording: false,\n        isListening: false,\n        volume: 0\n      });\n\n    } catch (error) {\n      const jodexError = this.handleError(error);\n      this.updateState({ error: jodexError.message });\n      this.onErrorCallbacks.forEach(cb => cb(jodexError));\n    }\n  }\n\n  /**\n   * Start speech recognition\n   */\n  private startSpeechRecognition(): void {\n    if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {\n      console.warn('Speech recognition not supported in this browser');\n      return;\n    }\n\n    const SpeechRecognition = (window as any).SpeechRecognition || (window as any).webkitSpeechRecognition;\n    const recognition = new SpeechRecognition();\n\n    recognition.continuous = true;\n    recognition.interimResults = true;\n    recognition.lang = this.settings.language;\n\n    recognition.onresult = (event: any) => {\n      let transcript = '';\n      for (let i = event.resultIndex; i < event.results.length; i++) {\n        transcript += event.results[i][0].transcript;\n      }\n\n      if (transcript.trim()) {\n        this.updateState({ transcript });\n        this.onTranscriptCallbacks.forEach(cb => cb(transcript));\n      }\n    };\n\n    recognition.onerror = (event: any) => {\n      console.error('Speech recognition error:', event.error);\n      if (event.error === 'not-allowed') {\n        const jodexError = new JodexError('Microphone permission denied', 'voice', 'MICROPHONE_DENIED');\n        this.onErrorCallbacks.forEach(cb => cb(jodexError));\n      }\n    };\n\n    recognition.start();\n  }\n\n  /**\n   * Stop speech recognition\n   */\n  private stopSpeechRecognition(): void {\n    // Speech recognition is stopped when the media stream is stopped\n  }\n\n  /**\n   * Start volume monitoring\n   */\n  private startVolumeMonitoring(): void {\n    if (!this.analyser || this.isDestroyed) return;\n\n    const checkVolume = () => {\n      if (!this.analyser || !this.state.isRecording || this.isDestroyed) return;\n\n      const dataArray = new Uint8Array(this.analyser.frequencyBinCount);\n      this.analyser.getByteFrequencyData(dataArray);\n\n      const average = dataArray.reduce((sum, value) => sum + value, 0) / dataArray.length;\n      const volume = Math.min(100, (average / 128) * 100);\n\n      this.updateState({ volume });\n\n      if (!this.isDestroyed) {\n        this.volumeAnimationFrame = requestAnimationFrame(checkVolume);\n      }\n    };\n\n    this.volumeAnimationFrame = requestAnimationFrame(checkVolume);\n  }\n\n  /**\n   * Stop volume monitoring\n   */\n  private stopVolumeMonitoring(): void {\n    if (this.volumeAnimationFrame) {\n      cancelAnimationFrame(this.volumeAnimationFrame);\n      this.volumeAnimationFrame = null;\n    }\n  }\n\n  /**\n   * Speak text using text-to-speech\n   */\n  async speak(text: string): Promise<void> {\n    if (!this.settings.enabled || !('speechSynthesis' in window)) {\n      return;\n    }\n\n    try {\n      // Cancel any ongoing speech\n      window.speechSynthesis.cancel();\n\n      const utterance = new SpeechSynthesisUtterance(text);\n      utterance.lang = this.settings.language;\n      utterance.rate = this.settings.rate;\n      utterance.pitch = this.settings.pitch;\n\n      return new Promise((resolve, reject) => {\n        utterance.onend = () => {\n          this.updateState({ isPlaying: false });\n          resolve();\n        };\n\n        utterance.onerror = (error) => {\n          this.updateState({ isPlaying: false });\n          reject(new JodexError('Text-to-speech failed', 'voice'));\n        };\n\n        this.updateState({ isPlaying: true });\n        window.speechSynthesis.speak(utterance);\n      });\n\n    } catch (error) {\n      const jodexError = this.handleError(error);\n      this.updateState({ error: jodexError.message });\n      this.onErrorCallbacks.forEach(cb => cb(jodexError));\n    }\n  }\n\n  /**\n   * Stop text-to-speech\n   */\n  stopSpeaking(): void {\n    if ('speechSynthesis' in window) {\n      window.speechSynthesis.cancel();\n      this.updateState({ isPlaying: false });\n    }\n  }\n\n  /**\n   * Update voice settings\n   */\n  updateSettings(settings: Partial<VoiceSettings>): void {\n    this.settings = { ...this.settings, ...settings };\n  }\n\n  /**\n   * Get current voice state\n   */\n  getState(): VoiceState {\n    return { ...this.state };\n  }\n\n  /**\n   * Get current voice settings\n   */\n  getSettings(): VoiceSettings {\n    return { ...this.settings };\n  }\n\n  /**\n   * Add state change listener\n   */\n  onStateChange(callback: (state: VoiceState) => void): void {\n    this.onStateChangeCallbacks.push(callback);\n  }\n\n  /**\n   * Add transcript listener\n   */\n  onTranscript(callback: (transcript: string) => void): void {\n    this.onTranscriptCallbacks.push(callback);\n  }\n\n  /**\n   * Add error listener\n   */\n  onError(callback: (error: JodexError) => void): void {\n    this.onErrorCallbacks.push(callback);\n  }\n\n  /**\n   * Update internal state\n   */\n  private updateState(updates: Partial<VoiceState>): void {\n    this.state = { ...this.state, ...updates };\n    this.onStateChangeCallbacks.forEach(cb => cb({ ...this.state }));\n  }\n\n  /**\n   * Handle errors and convert to JodexError\n   */\n  private handleError(error: any): JodexError {\n    if (error instanceof JodexError) {\n      return error;\n    }\n\n    const jodexError = new JodexError(error.message || 'Voice connection error', 'voice', 'VOICE_ERROR');\n    jodexError.details = error;\n    return jodexError;\n  }\n\n  /**\n   * Disconnect and clean up\n   */\n  async disconnect(): Promise<void> {\n    if (this.isDestroyed) return;\n\n    this.isDestroyed = true;\n\n    // Clear token refresh interval\n    if (this.tokenRefreshInterval) {\n      clearInterval(this.tokenRefreshInterval);\n      this.tokenRefreshInterval = null;\n    }\n\n    // Stop volume monitoring\n    this.stopVolumeMonitoring();\n\n    // Stop recording\n    await this.stopRecording();\n\n    // Stop speaking\n    this.stopSpeaking();\n\n    // Disconnect from room\n    if (this.room) {\n      await this.room.disconnect();\n      this.room = null;\n    }\n\n    // Clean up media stream\n    if (this.mediaStream) {\n      this.mediaStream.getTracks().forEach(track => {\n        track.stop();\n      });\n      this.mediaStream = null;\n    }\n\n    // Clean up audio tracks\n    if (this.localAudioTrack) {\n      await this.localAudioTrack.stop();\n      if ('dispose' in this.localAudioTrack && typeof this.localAudioTrack.dispose === 'function') {\n        await this.localAudioTrack.dispose();\n      }\n      this.localAudioTrack = null;\n    }\n\n    if (this.remoteAudioTrack) {\n      // Remote tracks don't need explicit stop/dispose\n      this.remoteAudioTrack = null;\n    }\n\n    // Clean up audio context\n    if (this.audioContext && this.audioContext.state !== 'closed') {\n      try {\n        await this.audioContext.close();\n      } catch (error) {\n        console.warn('Failed to close audio context:', error);\n      }\n      this.audioContext = null;\n      this.analyser = null;\n    }\n\n    // Cancel any ongoing speech synthesis\n    if ('speechSynthesis' in window) {\n      window.speechSynthesis.cancel();\n    }\n\n    // Clear callbacks\n    this.onStateChangeCallbacks = [];\n    this.onTranscriptCallbacks = [];\n    this.onErrorCallbacks = [];\n\n    // Reset state\n    this.state = {\n      isRecording: false,\n      isPlaying: false,\n      isListening: false,\n      transcript: '',\n      volume: 0,\n      isConnected: false,\n      error: undefined,\n    };\n  }\n}","import { Action, JodexAIProps } from '../types';\n\n/**\n * Action Queue Manager\n */\nexport class ActionManager {\n  private queue: Action[] = [];\n  private isProcessing = false;\n  private onActionCallback?: (action: Action) => void;\n\n  constructor(onAction?: (action: Action) => void) {\n    this.onActionCallback = onAction;\n  }\n\n  /**\n   * Add an action to the queue\n   */\n  addAction(action: Action): void {\n    this.queue.push(action);\n    this.processQueue();\n  }\n\n  /**\n   * Process the action queue\n   */\n  private async processQueue(): Promise<void> {\n    if (this.isProcessing || this.queue.length === 0) {\n      return;\n    }\n\n    this.isProcessing = true;\n\n    while (this.queue.length > 0) {\n      const action = this.queue.shift();\n      if (action) {\n        await this.executeAction(action);\n      }\n    }\n\n    this.isProcessing = false;\n  }\n\n  /**\n   * Execute a single action\n   */\n  private async executeAction(action: Action): Promise<void> {\n    try {\n      if (this.onActionCallback) {\n        // Call the parent application's action handler\n        this.onActionCallback(action);\n      }\n\n      // You can add built-in action handlers here\n      switch (action.type) {\n        case 'show_supply_forecast':\n          this.handleSupplyForecast(action);\n          break;\n        case 'show_farmer_list':\n          this.handleFarmerList(action);\n          break;\n        case 'show_weather_alerts':\n          this.handleWeatherAlerts(action);\n          break;\n        case 'show_disease_map':\n          this.handleDiseaseMap(action);\n          break;\n        case 'show_inventory':\n          this.handleInventory(action);\n          break;\n        case 'open_farmer_profile':\n          this.handleFarmerProfile(action);\n          break;\n        case 'send_notification':\n          this.handleNotification(action);\n          break;\n        default:\n          // Custom actions are just passed through to the parent app\n          break;\n      }\n    } catch (error) {\n      console.error('Failed to execute action:', action, error);\n    }\n  }\n\n  /**\n   * Built-in handlers for common actions\n   */\n  private handleSupplyForecast(action: Action): void {\n    console.log('Showing supply forecast:', action.data);\n    // Built-in logic for supply forecasts\n  }\n\n  private handleFarmerList(action: Action): void {\n    console.log('Showing farmer list:', action.data);\n    // Built-in logic for farmer lists\n  }\n\n  private handleWeatherAlerts(action: Action): void {\n    console.log('Showing weather alerts:', action.data);\n    // Built-in logic for weather alerts\n  }\n\n  private handleDiseaseMap(action: Action): void {\n    console.log('Showing disease map:', action.data);\n    // Built-in logic for disease mapping\n  }\n\n  private handleInventory(action: Action): void {\n    console.log('Showing inventory:', action.data);\n    // Built-in logic for inventory display\n  }\n\n  private handleFarmerProfile(action: Action): void {\n    console.log('Opening farmer profile:', action.data);\n    // Built-in logic for farmer profiles\n  }\n\n  private handleNotification(action: Action): void {\n    console.log('Sending notification:', action.data);\n    // Built-in logic for notifications\n\n    // Try to send a browser notification if permissions are granted\n    if ('Notification' in window && Notification.permission === 'granted') {\n      new Notification(action.data.title || 'Jodex Alert', {\n        body: action.data.message || action.data,\n        icon: '/favicon.ico',\n        tag: 'jodex-notification',\n      });\n    }\n  }\n\n  /**\n   * Clear all pending actions\n   */\n  clearQueue(): void {\n    this.queue = [];\n  }\n\n  /**\n   * Get the current queue status\n   */\n  getQueueStatus(): { pending: number; isProcessing: boolean } {\n    return {\n      pending: this.queue.length,\n      isProcessing: this.isProcessing,\n    };\n  }\n}\n\n/**\n * Validate action structure\n */\nexport function validateAction(action: any): action is Action {\n  return (\n    action &&\n    typeof action === 'object' &&\n    typeof action.type === 'string' &&\n    typeof action.data === 'object' &&\n    typeof action.priority === 'string' &&\n    typeof action.timestamp === 'string' &&\n    ['critical', 'high', 'medium', 'low'].includes(action.priority)\n  );\n}\n\n/**\n * Create a new action with default values\n */\nexport function createAction(\n  type: Action['type'],\n  data: any,\n  priority: Action['priority'] = 'medium'\n): Action {\n  return {\n    type,\n    data,\n    priority,\n    timestamp: new Date().toISOString(),\n  };\n}\n\n/**\n * Action type constants for easy reference\n */\nexport const ACTION_TYPES = {\n  SHOW_SUPPLY_FORECAST: 'show_supply_forecast',\n  SHOW_FARMER_LIST: 'show_farmer_list',\n  SHOW_WEATHER_ALERTS: 'show_weather_alerts',\n  SHOW_DISEASE_MAP: 'show_disease_map',\n  SHOW_INVENTORY: 'show_inventory',\n  OPEN_FARMER_PROFILE: 'open_farmer_profile',\n  SEND_NOTIFICATION: 'send_notification',\n  CUSTOM: 'custom',\n} as const;","import { Message, UIConfig, VoiceSettings, Alert, StorageData } from '../types';\n\n/**\n * Storage Manager for persisting data\n */\nexport class StorageManager {\n  private storageKey: string;\n  private isLocalStorageAvailable: boolean;\n\n  constructor(storageKey = 'jodex-ai-assistant') {\n    this.storageKey = storageKey;\n    this.isLocalStorageAvailable = this.checkLocalStorageAvailability();\n  }\n\n  /**\n   * Check if localStorage is available\n   */\n  private checkLocalStorageAvailability(): boolean {\n    try {\n      const testKey = '__jodex_test__';\n      localStorage.setItem(testKey, 'test');\n      localStorage.removeItem(testKey);\n      return true;\n    } catch (error) {\n      console.warn('localStorage is not available:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Save data to storage\n   */\n  save(data: Partial<StorageData>): void {\n    if (!this.isLocalStorageAvailable) {\n      console.warn('Cannot save to storage: localStorage not available');\n      return;\n    }\n\n    try {\n      const existingData = this.load();\n      const updatedData: StorageData = {\n        ...existingData,\n        ...data,\n        lastActivity: new Date().toISOString(),\n      };\n\n      localStorage.setItem(this.storageKey, JSON.stringify(updatedData));\n    } catch (error) {\n      console.error('Failed to save to storage:', error);\n    }\n  }\n\n  /**\n   * Load data from storage\n   */\n  load(): StorageData {\n    if (!this.isLocalStorageAvailable) {\n      return this.getDefaultStorageData();\n    }\n\n    try {\n      const stored = localStorage.getItem(this.storageKey);\n      if (!stored) {\n        return this.getDefaultStorageData();\n      }\n\n      const data = JSON.parse(stored);\n\n      // Convert timestamp strings back to Date objects\n      if (data.messages) {\n        data.messages = data.messages.map((msg: any) => ({\n          ...msg,\n          timestamp: new Date(msg.timestamp),\n        }));\n      }\n\n      if (data.alerts) {\n        data.alerts = data.alerts.map((alert: any) => ({\n          ...alert,\n          timestamp: new Date(alert.timestamp),\n          snoozedUntil: alert.snoozedUntil ? new Date(alert.snoozedUntil) : undefined,\n        }));\n      }\n\n      return { ...this.getDefaultStorageData(), ...data };\n    } catch (error) {\n      console.error('Failed to load from storage:', error);\n      return this.getDefaultStorageData();\n    }\n  }\n\n  /**\n   * Clear all stored data\n   */\n  clear(): void {\n    if (!this.isLocalStorageAvailable) {\n      return;\n    }\n\n    try {\n      localStorage.removeItem(this.storageKey);\n    } catch (error) {\n      console.error('Failed to clear storage:', error);\n    }\n  }\n\n  /**\n   * Get default storage data\n   */\n  private getDefaultStorageData(): StorageData {\n    return {\n      messages: [],\n      settings: {},\n      voiceSettings: {},\n      alerts: [],\n      lastActivity: new Date().toISOString(),\n    };\n  }\n\n  /**\n   * Save messages\n   */\n  saveMessages(messages: Message[]): void {\n    const limitedMessages = messages.slice(-100); // Keep only last 100 messages\n    this.save({ messages: limitedMessages });\n  }\n\n  /**\n   * Load messages\n   */\n  loadMessages(): Message[] {\n    const data = this.load();\n    return data.messages || [];\n  }\n\n  /**\n   * Save settings\n   */\n  saveSettings(settings: Partial<UIConfig>): void {\n    this.save({ settings });\n  }\n\n  /**\n   * Load settings\n   */\n  loadSettings(): Partial<UIConfig> {\n    const data = this.load();\n    return data.settings || {};\n  }\n\n  /**\n   * Save voice settings\n   */\n  saveVoiceSettings(settings: Partial<VoiceSettings>): void {\n    this.save({ voiceSettings: settings });\n  }\n\n  /**\n   * Load voice settings\n   */\n  loadVoiceSettings(): Partial<VoiceSettings> {\n    const data = this.load();\n    return data.voiceSettings || {};\n  }\n\n  /**\n   * Save alerts\n   */\n  saveAlerts(alerts: Alert[]): void {\n    // Remove expired alerts\n    const validAlerts = alerts.filter(alert => {\n      if (alert.dismissed) return false;\n      if (alert.snoozedUntil && new Date() > alert.snoozedUntil) return false;\n      // Remove alerts older than 30 days\n      const thirtyDaysAgo = new Date();\n      thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n      return alert.timestamp > thirtyDaysAgo;\n    });\n\n    this.save({ alerts: validAlerts });\n  }\n\n  /**\n   * Load alerts\n   */\n  loadAlerts(): Alert[] {\n    const data = this.load();\n    return data.alerts || [];\n  }\n\n  /**\n   * Get storage size\n   */\n  getStorageSize(): number {\n    if (!this.isLocalStorageAvailable) {\n      return 0;\n    }\n\n    try {\n      const stored = localStorage.getItem(this.storageKey);\n      return stored ? stored.length : 0;\n    } catch (error) {\n      return 0;\n    }\n  }\n\n  /**\n   * Check if storage is getting full\n   */\n  isStorageNearFull(): boolean {\n    const size = this.getStorageSize();\n    // localStorage typically has 5-10MB limit, warn at 4MB\n    return size > 4 * 1024 * 1024; // 4MB\n  }\n}\n\n/**\n * In-memory storage for fallback\n */\nexport class MemoryStorage {\n  private data: StorageData;\n\n  constructor() {\n    this.data = {\n      messages: [],\n      settings: {},\n      voiceSettings: {},\n      alerts: [],\n      lastActivity: new Date().toISOString(),\n    };\n  }\n\n  save(data: Partial<StorageData>): void {\n    this.data = {\n      ...this.data,\n      ...data,\n      lastActivity: new Date().toISOString(),\n    };\n  }\n\n  load(): StorageData {\n    return { ...this.data };\n  }\n\n  clear(): void {\n    this.data = {\n      messages: [],\n      settings: {},\n      voiceSettings: {},\n      alerts: [],\n      lastActivity: new Date().toISOString(),\n    };\n  }\n}\n\n/**\n * Factory function to create appropriate storage manager\n */\nexport function createStorageManager(storageKey = 'jodex-ai-assistant'): StorageManager | MemoryStorage {\n  try {\n    // Test localStorage availability\n    const testKey = '__jodex_storage_test__';\n    localStorage.setItem(testKey, 'test');\n    localStorage.removeItem(testKey);\n    return new StorageManager(storageKey);\n  } catch (error) {\n    console.warn('Falling back to memory storage');\n    return new MemoryStorage() as any;\n  }\n}","import React, { useState, useRef, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Message, UIConfig } from '../types';\n\ninterface ChatInterfaceProps {\n  messages: Message[];\n  isLoading: boolean;\n  onSendMessage: (message: string) => void;\n  onCollapse: () => void;\n  config: UIConfig;\n  showHeader: boolean;\n  showFooter: boolean;\n  showTimestamps: boolean;\n  voiceEnabled: boolean;\n}\n\nexport const ChatInterface: React.FC<ChatInterfaceProps> = ({\n  messages,\n  isLoading,\n  onSendMessage,\n  onCollapse,\n  config,\n  showHeader,\n  showFooter,\n  showTimestamps,\n  voiceEnabled,\n}) => {\n  const [inputValue, setInputValue] = useState('');\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  /**\n   * Scroll to bottom of messages\n   */\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  /**\n   * Handle form submission\n   */\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (inputValue.trim() && !isLoading) {\n      onSendMessage(inputValue);\n      setInputValue('');\n    }\n  };\n\n  /**\n   * Handle keyboard shortcuts\n   */\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSubmit(e as any);\n    }\n  };\n\n  /**\n   * Format timestamp\n   */\n  const formatTimestamp = (date: Date) => {\n    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n  };\n\n  return (\n    <div className=\"jodex-chat-container\">\n      {/* Header */}\n      {showHeader && (\n        <div className=\"jodex-chat-header\">\n          <div className=\"flex items-center gap-3\">\n            {config.logo ? (\n              <img src={config.logo} alt=\"Jodex AI\" className=\"w-6 h-6\" />\n            ) : (\n              <div className=\"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center\">\n                <span className=\"text-white text-xs font-bold\">JD</span>\n              </div>\n            )}\n            <h3 className=\"font-semibold text-gray-900 dark:text-gray-100\">\n              {config.title}\n            </h3>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            {/* Connection status indicator */}\n            <div className=\"flex items-center gap-1\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" />\n              <span className=\"text-xs text-gray-500 dark:text-gray-400\">Online</span>\n            </div>\n\n            {/* Collapse button */}\n            <button\n              onClick={onCollapse}\n              className=\"jodex-btn-icon\"\n              title=\"Collapse chat\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Messages */}\n      <div className=\"jodex-chat-messages\">\n        <AnimatePresence initial={false}>\n          {messages.length === 0 ? (\n            <motion.div\n              className=\"flex flex-col items-center justify-center h-full text-center p-8\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n            >\n              <div className=\"w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center mb-4\">\n                <svg className=\"w-6 h-6 text-green-600 dark:text-green-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z\" />\n                </svg>\n              </div>\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2\">\n                Welcome to Jodex AI Assistant\n              </h3>\n              <p className=\"text-sm text-gray-600 dark:text-gray-400 max-w-sm\">\n                I'm here to help you with agricultural supply chain management. Ask me about farmers, weather conditions, harvest data, or anything else related to your cacao operations.\n              </p>\n              {voiceEnabled && (\n                <p className=\"text-xs text-gray-500 dark:text-gray-500 mt-4\">\n                   You can also use voice input by clicking the microphone button\n                </p>\n              )}\n            </motion.div>\n          ) : (\n            messages.map((message, index) => (\n              <motion.div\n                key={message.id}\n                className={`jodex-message jodex-message-${message.role}`}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                exit={{ opacity: 0, y: -20 }}\n                transition={{ duration: 0.2, delay: index * 0.05 }}\n              >\n                {/* Avatar */}\n                <div className=\"jodex-message-avatar\">\n                  {message.role === 'user' ? (\n                    <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\n                    </svg>\n                  ) : (\n                    <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z\" clipRule=\"evenodd\" />\n                    </svg>\n                  )}\n                </div>\n\n                {/* Message content */}\n                <div className=\"jodex-message-content\">\n                  <div className=\"jodex-message-text\">\n                    {message.isStreaming ? (\n                      <div className=\"flex items-center gap-2\">\n                        <span>{message.content}</span>\n                        <div className=\"jodex-typing\">\n                          <div className=\"jodex-typing-dot\" />\n                          <div className=\"jodex-typing-dot\" />\n                          <div className=\"jodex-typing-dot\" />\n                        </div>\n                      </div>\n                    ) : (\n                      message.content\n                    )}\n                  </div>\n\n                  {showTimestamps && (\n                    <div className=\"jodex-message-timestamp\">\n                      {formatTimestamp(message.timestamp)}\n                    </div>\n                  )}\n\n                  {/* Actions */}\n                  {message.actions && message.actions.length > 0 && (\n                    <div className=\"mt-3 flex flex-wrap gap-2\">\n                      {message.actions.map((action, actionIndex) => (\n                        <div\n                          key={actionIndex}\n                          className=\"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 text-xs rounded-md\"\n                        >\n                          <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                          </svg>\n                          {action.type.replace('_', ' ')}\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              </motion.div>\n            ))\n          )}\n        </AnimatePresence>\n\n        {/* Loading indicator */}\n        {isLoading && (\n          <motion.div\n            className=\"jodex-message jodex-message-assistant\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n          >\n            <div className=\"jodex-message-avatar\">\n              <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n            <div className=\"jodex-message-content\">\n              <div className=\"jodex-typing\">\n                <div className=\"jodex-typing-dot\" />\n                <div className=\"jodex-typing-dot\" />\n                <div className=\"jodex-typing-dot\" />\n                <span className=\"ml-2 text-sm text-gray-500 dark:text-gray-400\">\n                  Jodex is thinking...\n                </span>\n              </div>\n            </div>\n          </motion.div>\n        )}\n\n        <div ref={messagesEndRef} />\n      </div>\n\n      {/* Footer with input */}\n      {showFooter && (\n        <div className=\"jodex-chat-input-container\">\n          <form onSubmit={handleSubmit} className=\"flex gap-2\">\n            <div className=\"flex-1 relative\">\n              <input\n                ref={inputRef}\n                type=\"text\"\n                value={inputValue}\n                onChange={(e) => setInputValue(e.target.value)}\n                onKeyDown={handleKeyDown}\n                placeholder=\"Ask about farmers, weather, or harvest data...\"\n                className=\"jodex-input\"\n                disabled={isLoading}\n                autoComplete=\"off\"\n              />\n              {isLoading && (\n                <div className=\"absolute right-3 top-1/2 -translate-y-1/2\">\n                  <div className=\"jodex-loading\" />\n                </div>\n              )}\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={!inputValue.trim() || isLoading}\n              className=\"jodex-btn jodex-btn-primary\"\n              title=\"Send message\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\n              </svg>\n            </button>\n          </form>\n\n          {/* Help text */}\n          <div className=\"mt-2 text-xs text-gray-500 dark:text-gray-400 text-center\">\n            Press Enter to send  Shift+Enter for new line\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};","import React, { useCallback } from 'react';\nimport { motion } from 'framer-motion';\nimport { VoiceState, UIConfig } from '../types';\nimport { BrowserCompatibility } from '../lib/browser-compatibility';\n\ninterface VoiceInterfaceProps {\n  voiceState: VoiceState;\n  onToggleRecording: () => void;\n  config: UIConfig;\n  browserCompatibility?: BrowserCompatibility;\n}\n\nexport const VoiceInterface: React.FC<VoiceInterfaceProps> = ({\n  voiceState,\n  onToggleRecording,\n  config,\n  browserCompatibility,\n}) => {\n  const getVolumeLevel = () => {\n    if (voiceState.volume < 30) return 'low';\n    if (voiceState.volume < 70) return 'medium';\n    return 'high';\n  };\n\n  const getButtonState = () => {\n    // Check browser compatibility first\n    if (browserCompatibility && !browserCompatibility.supported) return 'disabled';\n    if (!voiceState.isConnected || !config.theme) return 'disabled';\n    if (voiceState.isRecording) return 'recording';\n    if (voiceState.isPlaying) return 'playing';\n    if (voiceState.isListening) return 'listening';\n    return 'idle';\n  };\n\n  const buttonState = getButtonState();\n  const volumeLevel = getVolumeLevel();\n\n  const handleKeyDown = useCallback((event: React.KeyboardEvent) => {\n    // Support keyboard activation\n    if (event.key === 'Enter' || event.key === ' ') {\n      event.preventDefault();\n      onToggleRecording();\n    }\n    // Escape key to stop recording\n    if (event.key === 'Escape' && (buttonState === 'recording' || buttonState === 'listening')) {\n      event.preventDefault();\n      onToggleRecording();\n    }\n  }, [onToggleRecording, buttonState]);\n\n  return (\n    <div className=\"absolute bottom-6 right-6 z-10\" role=\"application\" aria-label=\"Voice interface\">\n      <motion.button\n        onClick={onToggleRecording}\n        onKeyDown={handleKeyDown}\n        className={`jodex-voice-btn jodex-voice-btn-${buttonState}`}\n        disabled={buttonState === 'disabled'}\n        whileHover={{ scale: buttonState !== 'disabled' ? 1.1 : 1 }}\n        whileTap={{ scale: buttonState !== 'disabled' ? 0.95 : 1 }}\n        tabIndex={buttonState === 'disabled' ? -1 : 0}\n        aria-label={\n          buttonState === 'recording'\n            ? 'Stop recording voice input'\n            : buttonState === 'playing'\n            ? 'Stop text-to-speech playback'\n            : buttonState === 'listening'\n            ? 'Voice assistant is listening'\n            : buttonState === 'disabled'\n            ? 'Voice features are unavailable'\n            : 'Start voice input'\n        }\n        aria-pressed={buttonState === 'recording' || buttonState === 'listening'}\n        aria-describedby=\"voice-status\"\n        aria-live=\"polite\"\n      >\n        {/* Microphone icon for recording/listening */}\n        {(buttonState === 'idle' || buttonState === 'recording' || buttonState === 'listening') && (\n          <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path fillRule=\"evenodd\" d=\"M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4zm4 10.93A7.001 7.001 0 0017 8a1 1 0 10-2 0A5 5 0 015 8a1 1 0 00-2 0 7.001 7.001 0 006 6.93V17H6a1 1 0 100 2h8a1 1 0 100-2h-3v-2.07z\" clipRule=\"evenodd\" />\n          </svg>\n        )}\n\n        {/* Stop icon for playing */}\n        {buttonState === 'playing' && (\n          <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z\" clipRule=\"evenodd\" />\n          </svg>\n        )}\n\n        {/* Disabled icon */}\n        {buttonState === 'disabled' && (\n          <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path fillRule=\"evenodd\" d=\"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z\" clipRule=\"evenodd\" />\n          </svg>\n        )}\n\n        {/* Volume indicator for recording */}\n        {voiceState.isRecording && (\n          <div\n            className={`jodex-volume-indicator jodex-volume-${volumeLevel}`}\n            role=\"progressbar\"\n            aria-valuenow={Math.round(voiceState.volume)}\n            aria-valuemin={0}\n            aria-valuemax={100}\n            aria-label={`Voice input volume: ${Math.round(voiceState.volume)}%`}\n          />\n        )}\n      </motion.button>\n\n      {/* Voice status text */}\n      {voiceState.isRecording && (\n        <motion.div\n          className=\"absolute -top-8 left-1/2 -translate-x-1/2 bg-red-500 text-white text-xs px-2 py-1 rounded-md whitespace-nowrap\"\n          initial={{ opacity: 0, y: 10 }}\n          animate={{ opacity: 1, y: 0 }}\n        >\n          Recording... {voiceState.volume > 0 && `(${Math.round(voiceState.volume)}%)`}\n        </motion.div>\n      )}\n\n      {voiceState.isPlaying && (\n        <motion.div\n          className=\"absolute -top-8 left-1/2 -translate-x-1/2 bg-blue-500 text-white text-xs px-2 py-1 rounded-md whitespace-nowrap\"\n          initial={{ opacity: 0, y: 10 }}\n          animate={{ opacity: 1, y: 0 }}\n        >\n          Speaking...\n        </motion.div>\n      )}\n\n      {voiceState.error && (\n        <motion.div\n          className=\"absolute -top-8 left-1/2 -translate-x-1/2 bg-red-500 text-white text-xs px-2 py-1 rounded-md whitespace-nowrap max-w-32 text-center\"\n          initial={{ opacity: 0, y: 10 }}\n          animate={{ opacity: 1, y: 0 }}\n        >\n          {voiceState.error}\n        </motion.div>\n      )}\n\n      {/* Transcript preview (when listening) */}\n      {voiceState.isListening && voiceState.transcript && (\n        <motion.div\n          className=\"absolute bottom-16 right-0 left-auto w-64 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg p-3 max-w-xs\"\n          initial={{ opacity: 0, y: 10 }}\n          animate={{ opacity: 1, y: 0 }}\n          role=\"status\"\n          aria-live=\"polite\"\n          aria-label=\"Voice transcript\"\n        >\n          <div className=\"text-xs text-gray-500 dark:text-gray-400 mb-1\">\n            Listening:\n          </div>\n          <div className=\"text-sm text-gray-800 dark:text-gray-200 truncate\">\n            {voiceState.transcript}\n          </div>\n        </motion.div>\n      )}\n\n      {/* Screen reader announcements */}\n      <div className=\"sr-only\" aria-live=\"assertive\" aria-atomic=\"true\">\n        {voiceState.isRecording && 'Recording voice input'}\n        {voiceState.isPlaying && 'Speaking response'}\n        {voiceState.isListening && 'Processing voice input'}\n        {voiceState.error && `Voice error: ${voiceState.error}`}\n      </div>\n\n      {/* Voice status description for screen readers */}\n      <div id=\"voice-status\" className=\"sr-only\">\n        Voice interface status: {buttonState}\n        {voiceState.isRecording && ` - Recording at ${Math.round(voiceState.volume)}% volume`}\n        {voiceState.transcript && ` - Transcript: ${voiceState.transcript}`}\n      </div>\n    </div>\n  );\n};","import React from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Alert } from '../types';\n\ninterface AlertPanelProps {\n  alerts: Alert[];\n  onAcknowledge: (alertId: string) => void;\n  onDismiss: (alertId: string) => void;\n}\n\nexport const AlertPanel: React.FC<AlertPanelProps> = ({\n  alerts,\n  onAcknowledge,\n  onDismiss,\n}) => {\n  // Filter out acknowledged alerts that are older than 5 seconds\n  const visibleAlerts = alerts.filter(alert => {\n    if (alert.acknowledged) {\n      const fiveSecondsAgo = new Date(Date.now() - 5000);\n      return alert.timestamp > fiveSecondsAgo;\n    }\n    return true;\n  });\n\n  const getAlertIcon = (type: Alert['type']) => {\n    switch (type) {\n      case 'weather':\n        return (\n          <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path d=\"M5.5 16a3.5 3.5 0 01-.369-6.98 4 4 0 117.753-1.977A4.5 4.5 0 1113.5 16h-8z\" />\n          </svg>\n        );\n      case 'disease':\n        return (\n          <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n          </svg>\n        );\n      case 'supply':\n        return (\n          <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path d=\"M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z\" />\n          </svg>\n        );\n      case 'inventory':\n        return (\n          <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path d=\"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z\" />\n          </svg>\n        );\n      default:\n        return (\n          <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clipRule=\"evenodd\" />\n          </svg>\n        );\n    }\n  };\n\n  const formatTimestamp = (date: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - date.getTime();\n    const diffMins = Math.floor(diffMs / 60000);\n\n    if (diffMins < 1) return 'Just now';\n    if (diffMins < 60) return `${diffMins}m ago`;\n    if (diffMins < 1440) return `${Math.floor(diffMins / 60)}h ago`;\n    return date.toLocaleDateString();\n  };\n\n  if (visibleAlerts.length === 0) {\n    return null;\n  }\n\n  return (\n    <div className=\"absolute top-4 left-4 right-4 z-10 pointer-events-none\">\n      <AnimatePresence>\n        {visibleAlerts.map((alert) => (\n          <motion.div\n            key={alert.id}\n            className={`jodex-alert jodex-alert-${alert.priority} pointer-events-auto mb-2 max-w-md mx-auto shadow-lg`}\n            initial={{ opacity: 0, y: -20, scale: 0.95 }}\n            animate={{ opacity: 1, y: 0, scale: 1 }}\n            exit={{ opacity: 0, y: -20, scale: 0.95 }}\n            transition={{ duration: 0.2 }}\n          >\n            <div className=\"flex items-start gap-3\">\n              {/* Alert icon */}\n              <div className={`flex-shrink-0 mt-0.5 ${\n                alert.priority === 'critical' ? 'text-red-500' :\n                alert.priority === 'high' ? 'text-orange-500' :\n                alert.priority === 'medium' ? 'text-yellow-500' :\n                'text-blue-500'\n              }`}>\n                {getAlertIcon(alert.type)}\n              </div>\n\n              {/* Alert content */}\n              <div className=\"flex-1 min-w-0\">\n                <div className=\"flex items-start justify-between gap-2\">\n                  <div>\n                    <h4 className=\"font-semibold text-sm\">{alert.title}</h4>\n                    <p className=\"text-sm mt-1 opacity-90\">{alert.message}</p>\n                  </div>\n\n                  {/* Actions */}\n                  <div className=\"flex items-center gap-1 flex-shrink-0\">\n                    {!alert.acknowledged && (\n                      <button\n                        onClick={() => onAcknowledge(alert.id)}\n                        className=\"jodex-btn-icon\"\n                        title=\"Acknowledge alert\"\n                      >\n                        <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                          <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n                        </svg>\n                      </button>\n                    )}\n\n                    <button\n                      onClick={() => onDismiss(alert.id)}\n                      className=\"jodex-btn-icon\"\n                      title=\"Dismiss alert\"\n                    >\n                      <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                      </svg>\n                    </button>\n                  </div>\n                </div>\n\n                {/* Footer with timestamp and status */}\n                <div className=\"flex items-center justify-between mt-2 text-xs opacity-75\">\n                  <span>{formatTimestamp(alert.timestamp)}</span>\n                  {alert.acknowledged && (\n                    <span className=\"flex items-center gap-1\">\n                      <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                      </svg>\n                      Acknowledged\n                    </span>\n                  )}\n                </div>\n\n                {/* Alert actions */}\n                {alert.actions && alert.actions.length > 0 && (\n                  <div className=\"mt-3 flex flex-wrap gap-2\">\n                    {alert.actions.map((action, index) => (\n                      <div\n                        key={index}\n                        className=\"inline-flex items-center gap-1 px-2 py-1 bg-white/20 dark:bg-black/20 text-xs rounded-md\"\n                      >\n                        <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                          <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                        </svg>\n                        {action.type.replace('_', ' ')}\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </div>\n          </motion.div>\n        ))}\n      </AnimatePresence>\n    </div>\n  );\n};","import React, { useEffect, useState } from 'react';\n\ninterface NoSSRProps {\n  children: React.ReactNode;\n  fallback?: React.ReactNode;\n}\n\n/**\n * Component to prevent SSR hydration mismatches by only rendering on client-side\n */\nexport const NoSSR: React.FC<NoSSRProps> = ({ children, fallback = null }) => {\n  const [isMounted, setIsMounted] = useState(false);\n\n  useEffect(() => {\n    setIsMounted(true);\n  }, []);\n\n  if (!isMounted) {\n    return <>{fallback}</>;\n  }\n\n  return <>{children}</>;\n};","import React, { Component, ErrorInfo, ReactNode } from 'react';\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n  onError?: (error: Error, errorInfo: ErrorInfo) => void;\n  showRetry?: boolean;\n}\n\ninterface State {\n  hasError: boolean;\n  error?: Error;\n  errorInfo?: ErrorInfo;\n}\n\nexport class ErrorBoundary extends Component<Props, State> {\n  private retryCount = 0;\n  private maxRetries = 3;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return {\n      hasError: true,\n      error,\n    };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    this.setState({\n      error,\n      errorInfo,\n    });\n\n    // Log error for debugging\n    console.error('Jodex AI Assistant Error Boundary:', error, errorInfo);\n\n    // Call error callback if provided\n    this.props.onError?.(error, errorInfo);\n  }\n\n  handleRetry = () => {\n    if (this.retryCount < this.maxRetries) {\n      this.retryCount++;\n      this.setState({ hasError: false, error: undefined, errorInfo: undefined });\n    }\n  };\n\n  getErrorType = (error?: Error): string => {\n    if (!error) return 'unknown';\n\n    const message = error.message.toLowerCase();\n\n    if (message.includes('network') || message.includes('fetch')) {\n      return 'network';\n    }\n    if (message.includes('voice') || message.includes('audio')) {\n      return 'voice';\n    }\n    if (message.includes('api') || message.includes('openai')) {\n      return 'api';\n    }\n    if (message.includes('permission') || message.includes('denied')) {\n      return 'permission';\n    }\n\n    return 'general';\n  };\n\n  getErrorMessage = (error?: Error): string => {\n    const errorType = this.getErrorType(error);\n\n    switch (errorType) {\n      case 'network':\n        return 'Network connection error. Please check your internet connection and try again.';\n      case 'voice':\n        return 'Voice features are unavailable. This might be due to browser limitations or missing permissions.';\n      case 'api':\n        return 'AI service temporarily unavailable. Please try again in a moment.';\n      case 'permission':\n        return 'Permission required. Please allow microphone access to use voice features.';\n      default:\n        return 'An unexpected error occurred. Please refresh the page or try again.';\n    }\n  };\n\n  render() {\n    if (this.state.hasError) {\n      // Custom fallback UI\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      const errorType = this.getErrorType(this.state.error);\n      const canRetry = this.props.showRetry && this.retryCount < this.maxRetries;\n\n      return (\n        <div\n          className=\"jodex-error-boundary flex flex-col items-center justify-center p-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg\"\n          role=\"alert\"\n          aria-live=\"assertive\"\n        >\n          <div className=\"text-center max-w-md\">\n            {/* Error Icon */}\n            <div className=\"mb-4\">\n              <svg\n                className=\"w-12 h-12 mx-auto text-red-500\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n                aria-hidden=\"true\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\n                />\n              </svg>\n            </div>\n\n            {/* Error Message */}\n            <h3 className=\"text-lg font-semibold text-red-800 dark:text-red-200 mb-2\">\n              Something went wrong\n            </h3>\n\n            <p className=\"text-sm text-red-600 dark:text-red-300 mb-6\">\n              {this.getErrorMessage(this.state.error)}\n            </p>\n\n            {/* Error details (for development) */}\n            {process.env.NODE_ENV === 'development' && this.state.error && (\n              <details className=\"mb-4 text-left\">\n                <summary className=\"cursor-pointer text-xs text-red-500 hover:text-red-400\">\n                  Error details\n                </summary>\n                <pre className=\"mt-2 text-xs bg-red-100 dark:bg-red-900/30 p-2 rounded overflow-auto max-h-32\">\n                  <code>\n                    {this.state.error.toString()}\n                    {this.state.errorInfo && '\\n' + this.state.errorInfo.componentStack}\n                  </code>\n                </pre>\n              </details>\n            )}\n\n            {/* Retry Button */}\n            {canRetry && (\n              <button\n                onClick={this.handleRetry}\n                className=\"jodex-btn jodex-btn-primary text-sm\"\n                aria-label=\"Retry loading the component\"\n              >\n                Try Again {this.retryCount > 0 && `(${this.maxRetries - this.retryCount} attempts left)`}\n              </button>\n            )}\n\n            {/* Retry exhausted message */}\n            {this.retryCount >= this.maxRetries && (\n              <p className=\"text-xs text-red-500 mt-2\">\n                Maximum retry attempts reached. Please refresh the page.\n              </p>\n            )}\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\n// HOC to wrap components with error boundary\nexport const withErrorBoundary = <P extends object>(\n  Component: React.ComponentType<P>,\n  errorBoundaryProps?: Omit<Props, 'children'>\n) => {\n  const WrappedComponent = (props: P) => (\n    <ErrorBoundary {...errorBoundaryProps}>\n      <Component {...props} />\n    </ErrorBoundary>\n  );\n\n  WrappedComponent.displayName = `withErrorBoundary(${Component.displayName || Component.name})`;\n\n  return WrappedComponent;\n};\n\n// Hook for functional components\nexport const useErrorBoundary = () => {\n  const [error, setError] = React.useState<Error | null>(null);\n\n  const resetError = React.useCallback(() => {\n    setError(null);\n  }, []);\n\n  const captureError = React.useCallback((error: Error) => {\n    setError(error);\n  }, []);\n\n  // Throw error to be caught by nearest error boundary\n  if (error) {\n    throw error;\n  }\n\n  return { captureError, resetError };\n};","/**\n * Browser compatibility utilities for Jodex AI Assistant\n */\n\nexport interface BrowserCompatibility {\n  supported: boolean;\n  features: {\n    webAudio: boolean;\n    mediaDevices: boolean;\n    getUserMedia: boolean;\n    webkitSpeechRecognition: boolean;\n    speechRecognition: boolean;\n    webRTC: boolean;\n  };\n  browser: {\n    name: string;\n    version: string;\n    isMobile: boolean;\n  };\n  issues: string[];\n}\n\n/**\n * Check browser compatibility for voice features\n */\nexport function checkBrowserCompatibility(): BrowserCompatibility {\n  // Default to unsupported until checks pass\n  const compatibility: BrowserCompatibility = {\n    supported: false,\n    features: {\n      webAudio: false,\n      mediaDevices: false,\n      getUserMedia: false,\n      webkitSpeechRecognition: false,\n      speechRecognition: false,\n      webRTC: false,\n    },\n    browser: {\n      name: 'unknown',\n      version: 'unknown',\n      isMobile: false,\n    },\n    issues: [],\n  };\n\n  try {\n    // Check for basic window object\n    if (typeof window === 'undefined') {\n      compatibility.issues.push('Not running in a browser environment');\n      return compatibility;\n    }\n\n    // Browser detection\n    const userAgent = navigator.userAgent;\n    let browserName = 'unknown';\n    let browserVersion = 'unknown';\n\n    // Chrome\n    if (/Chrome/.test(userAgent) && !/Chromium|Edge|Edg|Opera|OPR\\//.test(userAgent)) {\n      browserName = 'Chrome';\n      const match = userAgent.match(/Chrome\\/(\\d+)/);\n      browserVersion = match ? match[1] : 'unknown';\n    }\n    // Safari\n    else if (/Safari/.test(userAgent) && !/Chrome|Chromium|Edge|Edg|Opera|OPR\\//.test(userAgent)) {\n      browserName = 'Safari';\n      const match = userAgent.match(/Version\\/(\\d+)/);\n      browserVersion = match ? match[1] : 'unknown';\n    }\n    // Firefox\n    else if (/Firefox/.test(userAgent)) {\n      browserName = 'Firefox';\n      const match = userAgent.match(/Firefox\\/(\\d+)/);\n      browserVersion = match ? match[1] : 'unknown';\n    }\n    // Edge\n    else if (/Edge|Edg/.test(userAgent)) {\n      browserName = 'Edge';\n      const match = userAgent.match(/(?:Edge|Edg)\\/(\\d+)/);\n      browserVersion = match ? match[1] : 'unknown';\n    }\n\n    // Mobile detection\n    const isMobile = /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);\n\n    compatibility.browser = {\n      name: browserName,\n      version: browserVersion,\n      isMobile,\n    };\n\n    // Check for Web Audio API\n    compatibility.features.webAudio = !!(window.AudioContext || (window as any).webkitAudioContext);\n    if (!compatibility.features.webAudio) {\n      compatibility.issues.push('Web Audio API not supported');\n    }\n\n    // Check for MediaDevices\n    compatibility.features.mediaDevices = !!(navigator.mediaDevices);\n    if (!compatibility.features.mediaDevices) {\n      compatibility.issues.push('MediaDevices API not supported');\n    }\n\n    // Check for getUserMedia\n    compatibility.features.getUserMedia = !!(navigator.mediaDevices?.getUserMedia) ||\n      !!(navigator as any).getUserMedia ||\n      !!(navigator as any).webkitGetUserMedia ||\n      !!(navigator as any).mozGetUserMedia;\n    if (!compatibility.features.getUserMedia) {\n      compatibility.issues.push('getUserMedia not supported');\n    }\n\n    // Check for Speech Recognition\n    compatibility.features.speechRecognition = !!(window as any).SpeechRecognition;\n    compatibility.features.webkitSpeechRecognition = !!(window as any).webkitSpeechRecognition;\n\n    if (!compatibility.features.speechRecognition && !compatibility.features.webkitSpeechRecognition) {\n      compatibility.issues.push('Speech Recognition not supported');\n    }\n\n    // Check for WebRTC\n    compatibility.features.webRTC = !!(\n      window.RTCPeerConnection ||\n      (window as any).webkitRTCPeerConnection ||\n      (window as any).mozRTCPeerConnection ||\n      (window as any).RTCPeerConnection\n    );\n    if (!compatibility.features.webRTC) {\n      compatibility.issues.push('WebRTC not supported');\n    }\n\n    // Browser-specific checks\n    if (browserName === 'Safari' && parseInt(browserVersion) < 14) {\n      compatibility.issues.push('Safari version 14+ required for full voice support');\n    }\n\n    if (browserName === 'Chrome' && parseInt(browserVersion) < 80) {\n      compatibility.issues.push('Chrome version 80+ required for full voice support');\n    }\n\n    if (browserName === 'Firefox' && parseInt(browserVersion) < 75) {\n      compatibility.issues.push('Firefox version 75+ required for full voice support');\n    }\n\n    // Check if core features are available\n    const hasCoreFeatures = compatibility.features.mediaDevices &&\n                           compatibility.features.getUserMedia &&\n                           (compatibility.features.speechRecognition || compatibility.features.webkitSpeechRecognition);\n\n    // Consider supported if core features work and no major issues\n    const majorIssues = compatibility.issues.filter(issue =>\n      issue.includes('not supported') || issue.includes('required')\n    ).length;\n\n    compatibility.supported = hasCoreFeatures && majorIssues === 0;\n\n  } catch (error) {\n    compatibility.issues.push(`Error checking compatibility: ${error}`);\n  }\n\n  return compatibility;\n}\n\n/**\n * Get browser-specific workarounds and fixes\n */\nexport function getBrowserWorkarounds(browserName: string): string[] {\n  const workarounds: string[] = [];\n\n  switch (browserName) {\n    case 'Safari':\n      workarounds.push('Safari requires user interaction before accessing microphone');\n      workarounds.push('Consider using HTTPS for microphone access in Safari');\n      break;\n    case 'Chrome':\n      workarounds.push('Chrome may require HTTPS for microphone access');\n      break;\n    case 'Firefox':\n      workarounds.push('Firefox may have stricter microphone permissions');\n      break;\n    case 'Edge':\n      workarounds.push('Edge should work well with voice features');\n      break;\n  }\n\n  return workarounds;\n}\n\n/**\n * Check if HTTPS is required for microphone access\n */\nexport function requiresHTTPS(): boolean {\n  const userAgent = navigator.userAgent;\n\n  // Most browsers require HTTPS for getUserMedia\n  if (/Chrome|Firefox|Edge|Edg/.test(userAgent)) {\n    return location.protocol !== 'https:' && location.hostname !== 'localhost';\n  }\n\n  return false;\n}\n\n/**\n * Get user-friendly error message for unsupported features\n */\nexport function getUnsupportedFeatureMessage(compatibility: BrowserCompatibility): string[] {\n  const messages: string[] = [];\n\n  if (!compatibility.features.getUserMedia) {\n    messages.push('Your browser doesn\\'t support microphone access. Voice features won\\'t be available.');\n  }\n\n  if (!compatibility.features.speechRecognition && !compatibility.features.webkitSpeechRecognition) {\n    messages.push('Your browser doesn\\'t support speech recognition. Voice-to-text won\\'t work.');\n  }\n\n  if (!compatibility.features.webAudio) {\n    messages.push('Your browser doesn\\'t support Web Audio. Audio playback may be limited.');\n  }\n\n  if (!compatibility.features.webRTC) {\n    messages.push('Your browser doesn\\'t support WebRTC. Real-time communication features won\\'t work.');\n  }\n\n  if (compatibility.browser.isMobile) {\n    messages.push('Mobile browsers may have limited voice functionality. Consider using a desktop browser for the best experience.');\n  }\n\n  return messages;\n}","import type { ComponentType } from 'react';\nimport { lazy } from 'react';\n\n/**\n * Dynamic import utilities for lazy loading heavy dependencies\n */\n\n// Direct import for framer-motion to avoid DTS issues\nexport const importMotion = async (): Promise<any> => {\n  const motionModule = await import('framer-motion');\n  return motionModule.motion;\n};\n\n// Dynamic import for livekit-client\nexport const importLiveKit = async () => {\n  const livekitModule = await import('livekit-client');\n  return {\n    connect: livekitModule.connect,\n    RoomEvent: livekitModule.RoomEvent,\n    DataPacket_Kind: livekitModule.DataPacket_Kind,\n    ParticipantPermission: livekitModule.ParticipantPermission,\n    ConnectionQuality: livekitModule.ConnectionQuality,\n    Track: livekitModule.Track,\n  };\n};\n\n// Dynamic import for zustand\nexport const importZustand = async () => {\n  const zustandModule = await import('zustand');\n  return zustandModule.create;\n};\n\n// Dynamic import for openai (when not using API proxy)\nexport const importOpenAI = async () => {\n  const openaiModule = await import('openai');\n  return openaiModule.default;\n};\n\n/**\n * Lazy loading wrapper for components that use heavy dependencies\n */\nexport interface LazyComponentOptions {\n  fallback?: ComponentType;\n  loadingDelay?: number;\n}\n\nexport const createLazyComponent = <T extends ComponentType<any>>(\n  importFunc: () => Promise<{ default: T }>,\n  options: LazyComponentOptions = {}\n) => {\n  const { fallback, loadingDelay = 200 } = options;\n\n  return lazy(() => {\n    return new Promise<{ default: T }>((resolve) => {\n      if (loadingDelay > 0) {\n        setTimeout(() => {\n          importFunc().then(resolve);\n        }, loadingDelay);\n      } else {\n        importFunc().then(resolve);\n      }\n    });\n  });\n};\n\n/**\n * Preload critical dependencies for better performance\n */\nexport const preloadDependencies = async () => {\n  const preloadPromises: Promise<void>[] = [];\n\n  // Preload motion\n  preloadPromises.push(\n    import('framer-motion').then(() => {\n      // Motion loaded\n    })\n  );\n\n  // Preload zustand\n  preloadPromises.push(\n    import('zustand').then(() => {\n      // Zustand loaded\n    })\n  );\n\n  try {\n    await Promise.all(preloadPromises);\n  } catch (error) {\n    console.warn('Failed to preload some dependencies:', error);\n  }\n};\n\n/**\n * Check if dependency is available\n */\nexport const isDependencyAvailable = async (importFunc: () => Promise<any>): Promise<boolean> => {\n  try {\n    await importFunc();\n    return true;\n  } catch {\n    return false;\n  }\n};\n\n/**\n * Load voice dependencies conditionally\n */\nexport const loadVoiceDependencies = async () => {\n  const voiceDependencies = {\n    motion: false,\n    livekit: false,\n  };\n\n  try {\n    // Check browser support first\n    if (typeof window !== 'undefined' && navigator.mediaDevices) {\n      // Load motion for voice UI\n      await import('framer-motion');\n      voiceDependencies.motion = true;\n\n      // Load livekit only if WebRTC is supported\n      if (\n        window.RTCPeerConnection ||\n        (window as any).webkitRTCPeerConnection ||\n        (window as any).mozRTCPeerConnection\n      ) {\n        await import('livekit-client');\n        voiceDependencies.livekit = true;\n      }\n    }\n  } catch (error) {\n    console.warn('Failed to load voice dependencies:', error);\n  }\n\n  return voiceDependencies;\n};","import { useState, useEffect, useCallback, useRef } from 'react';\nimport type { FC } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { create } from 'zustand';\n\nimport {\n  JodexAIProps,\n  JodexAIState,\n  Message,\n  VoiceState,\n  Alert,\n  UIConfig,\n  Theme\n} from './types';\nimport { OpenAIClient } from './lib/openai';\nimport { VoiceConnection } from './lib/livekit';\nimport { ActionManager } from './lib/actions';\nimport { createStorageManager } from './lib/storage';\n\nimport { ChatInterface } from './components/ChatInterface';\nimport { VoiceInterface } from './components/VoiceInterface';\nimport { AlertPanel } from './components/AlertPanel';\nimport { NoSSR } from './components/NoSSR';\nimport { ErrorBoundary } from './components/ErrorBoundary';\nimport { checkBrowserCompatibility } from './lib/browser-compatibility';\nimport { loadVoiceDependencies } from './lib/dynamic-imports';\n\n// Default configuration\nconst DEFAULT_CONFIG = {\n  position: 'bottom-right' as const,\n  width: 384,\n  height: 600,\n  collapsed: false,\n  showHeader: true,\n  showFooter: true,\n  showTimestamps: true,\n  maxMessages: 50,\n  animations: true,\n  title: 'Jodex AI Assistant',\n};\n\nconst DEFAULT_THEME: Theme = {\n  mode: 'system',\n  primaryColor: '#3b82f6',\n  backgroundColor: undefined,\n  textColor: undefined,\n  borderColor: undefined,\n  accentColor: undefined,\n  customCSS: undefined,\n};\n\n/**\n * Zustand store for managing component state\n */\ninterface JodexStore extends JodexAIState {\n  // Actions\n  setIsConnected: (connected: boolean) => void;\n  setIsLoading: (loading: boolean) => void;\n  addMessage: (message: Message) => void;\n  updateMessage: (id: string, updates: Partial<Message>) => void;\n  setMessages: (messages: Message[]) => void;\n  updateVoiceState: (updates: Partial<VoiceState>) => void;\n  addAlert: (alert: Alert) => void;\n  updateAlert: (id: string, updates: Partial<Alert>) => void;\n  removeAlert: (id: string) => void;\n  setConfig: (config: UIConfig) => void;\n  setError: (error?: string) => void;\n  clearError: () => void;\n}\n\nconst useJodexStore = create<JodexStore>((set, get) => ({\n  // Initial state\n  isConnected: false,\n  isLoading: false,\n  messages: [],\n  voiceState: {\n    isRecording: false,\n    isPlaying: false,\n    isListening: false,\n    transcript: '',\n    volume: 0,\n    isConnected: false,\n    error: undefined,\n  },\n  alerts: [],\n  config: { ...DEFAULT_CONFIG, theme: DEFAULT_THEME },\n  error: undefined,\n\n  // Actions\n  setIsConnected: (connected) => set({ isConnected: connected }),\n  setIsLoading: (loading) => set({ isLoading: loading }),\n  addMessage: (message) => set((state) => ({\n    messages: [...state.messages.slice(-(state.config.maxMessages || 50) + 1), message]\n  })),\n  updateMessage: (id, updates) => set((state) => ({\n    messages: state.messages.map(msg =>\n      msg.id === id ? { ...msg, ...updates } : msg\n    )\n  })),\n  setMessages: (messages) => set({ messages }),\n  updateVoiceState: (updates) => set((state) => ({\n    voiceState: { ...state.voiceState, ...updates }\n  })),\n  addAlert: (alert) => set((state) => ({\n    alerts: [alert, ...state.alerts].slice(0, 10) // Keep only last 10 alerts\n  })),\n  updateAlert: (id, updates) => set((state) => ({\n    alerts: state.alerts.map(alert =>\n      alert.id === id ? { ...alert, ...updates } : alert\n    )\n  })),\n  removeAlert: (id) => set((state) => ({\n    alerts: state.alerts.filter(alert => alert.id !== id)\n  })),\n  setConfig: (config) => set({ config }),\n  setError: (error) => set({ error }),\n  clearError: () => set({ error: undefined }),\n}));\n\n/**\n * Main Jodex AI Assistant Component\n */\nexport const JodexAI: FC<JodexAIProps> = (props) => {\n  const {\n    apiUrl,\n    apiKey,\n    livekitUrl,\n    livekitToken,\n    systemPrompt,\n    instructions,\n    model = 'gpt-4-turbo-preview',\n    temperature = 0.7,\n    maxTokens = 2000,\n    datasets,\n    theme = DEFAULT_THEME,\n    position = DEFAULT_CONFIG.position,\n    width = DEFAULT_CONFIG.width,\n    height = DEFAULT_CONFIG.height,\n    collapsed = DEFAULT_CONFIG.collapsed,\n    voiceEnabled = true,\n    showHeader = DEFAULT_CONFIG.showHeader,\n    showFooter = DEFAULT_CONFIG.showFooter,\n    showTimestamps = DEFAULT_CONFIG.showTimestamps,\n    maxMessages = DEFAULT_CONFIG.maxMessages,\n    animations = DEFAULT_CONFIG.animations,\n    logo,\n    title = DEFAULT_CONFIG.title,\n    voiceSettings,\n    onAction,\n    onMessage,\n    onError,\n    onReady,\n    onVoiceStart,\n    onVoiceEnd,\n    onAlert,\n    streaming = true,\n    retryAttempts = 3,\n    rateLimitPerMinute = 10,\n    enableAlerts = true,\n    alertRules = [],\n    debugMode = false,\n  } = props;\n\n  // Store state\n  const {\n    isConnected,\n    isLoading,\n    messages,\n    voiceState,\n    alerts,\n    config,\n    error,\n    setIsConnected,\n    setIsLoading,\n    addMessage,\n    updateMessage,\n    setMessages,\n    updateVoiceState,\n    addAlert,\n    updateAlert,\n    removeAlert,\n    setConfig,\n    setError,\n    clearError,\n  } = useJodexStore();\n\n  // Component refs\n  const openaiClientRef = useRef<OpenAIClient | null>(null);\n  const voiceConnectionRef = useRef<VoiceConnection | null>(null);\n  const actionManagerRef = useRef<ActionManager | null>(null);\n  const storageRef = useRef<any>(null);\n  const isInitializedRef = useRef(false);\n\n  // Local state\n  const [isCollapsed, setIsCollapsed] = useState(collapsed);\n  const [currentTheme, setCurrentTheme] = useState<Theme>(theme as Theme);\n  const [voiceDependenciesLoaded, setVoiceDependenciesLoaded] = useState(false);\n  const [browserCompatibility, setBrowserCompatibility] = useState(() => {\n    // Only check compatibility on client-side\n    if (typeof window !== 'undefined') {\n      return checkBrowserCompatibility();\n    }\n    return {\n      supported: false,\n      features: {\n        webAudio: false,\n        mediaDevices: false,\n        getUserMedia: false,\n        webkitSpeechRecognition: false,\n        speechRecognition: false,\n        webRTC: false,\n      },\n      browser: {\n        name: 'unknown',\n        version: 'unknown',\n        isMobile: false,\n      },\n      issues: ['Server-side rendering'],\n    };\n  });\n\n  /**\n   * Initialize the component\n   */\n  const initialize = useCallback(async () => {\n    if (isInitializedRef.current) return;\n\n    try {\n      setIsLoading(true);\n      clearError();\n\n      // Initialize storage\n      storageRef.current = createStorageManager('jodex-ai-assistant');\n\n      // Load saved data\n      const savedMessages = storageRef.current.loadMessages();\n      if (savedMessages.length > 0) {\n        setMessages(savedMessages);\n      }\n\n      // Initialize OpenAI client\n      openaiClientRef.current = new OpenAIClient({\n        apiUrl,\n        apiKey, // Fallback for backward compatibility\n        systemPrompt,\n        instructions,\n        datasets,\n        model,\n        temperature,\n        maxTokens,\n        streaming,\n      });\n\n      // Initialize action manager\n      actionManagerRef.current = new ActionManager(onAction);\n\n      // Initialize voice connection if enabled\n      if (voiceEnabled && livekitUrl) {\n        try {\n          // Use server-side token generation by default, but allow legacy token usage\n          voiceConnectionRef.current = new VoiceConnection({\n            url: livekitUrl,\n            roomName: 'jodex-ai-room',\n            participantName: 'Jodex AI User',\n            useServerToken: !livekitToken, // Use server-side token if no token provided\n            token: livekitToken, // Use provided token if available (legacy mode)\n            settings: voiceSettings,\n          });\n\n          // Set up voice event listeners\n          voiceConnectionRef.current.onStateChange((state) => {\n            updateVoiceState(state);\n          });\n\n          voiceConnectionRef.current.onTranscript((transcript) => {\n            if (transcript.trim()) {\n              handleSendMessage(transcript);\n            }\n          });\n\n          voiceConnectionRef.current.onError((error) => {\n            setError(error.message);\n            onError?.(error);\n          });\n\n        } catch (voiceError) {\n          console.warn('Voice initialization failed:', voiceError);\n          if (debugMode) {\n            console.error('Voice error details:', voiceError);\n          }\n        }\n      }\n\n      // Set up configuration\n      const finalConfig: UIConfig = {\n        ...DEFAULT_CONFIG,\n        position,\n        width: width ?? DEFAULT_CONFIG.width,\n        height: height ?? DEFAULT_CONFIG.height,\n        collapsed,\n        showHeader,\n        showFooter,\n        showTimestamps,\n        maxMessages,\n        animations,\n        logo: logo || undefined,\n        title,\n        theme: currentTheme,\n      };\n\n      setConfig(finalConfig);\n\n      setIsConnected(true);\n      setIsLoading(false);\n\n      onReady?.();\n\n    } catch (error) {\n      console.error('Initialization failed:', error);\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      setError(errorMessage);\n      onError?.(error as Error);\n      setIsLoading(false);\n    }\n\n    isInitializedRef.current = true;\n  }, [\n    apiKey, systemPrompt, instructions, datasets, model, temperature, maxTokens,\n    streaming, voiceEnabled, livekitUrl, livekitToken, voiceSettings, onAction,\n    onReady, onError, position, width, height, collapsed, showHeader, showFooter,\n    showTimestamps, maxMessages, animations, logo, title, currentTheme,\n    setIsLoading, clearError, setMessages, updateVoiceState, setError,\n    setConfig, setIsConnected, addMessage, debugMode,\n  ]);\n\n  /**\n   * Handle sending a message\n   */\n  const handleSendMessage = useCallback(async (content: string) => {\n    if (!content.trim() || !openaiClientRef.current || isLoading) {\n      return;\n    }\n\n    let assistantMessage: Message;\n\n    try {\n      setIsLoading(true);\n\n      // Add user message\n      const userMessage: Message = {\n        id: `user-${Date.now()}`,\n        content: content.trim(),\n        role: 'user',\n        timestamp: new Date(),\n      };\n      addMessage(userMessage);\n      onMessage?.(userMessage);\n\n      // Create assistant message placeholder\n      assistantMessage = {\n        id: `assistant-${Date.now()}`,\n        content: '',\n        role: 'assistant',\n        timestamp: new Date(),\n        isStreaming: true,\n      };\n      addMessage(assistantMessage);\n\n      // Get AI response\n      if (streaming) {\n        let fullContent = '';\n        const stream = openaiClientRef.current.streamChatCompletion(messages);\n\n        for await (const chunk of stream) {\n          fullContent += chunk.content;\n\n          updateMessage(assistantMessage.id, {\n            content: fullContent,\n            isStreaming: true,\n          });\n\n          // Handle actions when streaming is complete\n          if (chunk.actions && chunk.actions.length > 0) {\n            chunk.actions.forEach(action => {\n              actionManagerRef.current?.addAction(action);\n            });\n          }\n        }\n\n        updateMessage(assistantMessage.id, {\n          content: fullContent,\n          isStreaming: false,\n        });\n\n      } else {\n        const response = await openaiClientRef.current.chatCompletion(messages);\n\n        updateMessage(assistantMessage.id, {\n          content: response.content,\n          isStreaming: false,\n          actions: response.actions,\n        });\n\n        // Handle actions\n        if (response.actions && response.actions.length > 0) {\n          response.actions.forEach(action => {\n            actionManagerRef.current?.addAction(action);\n          });\n        }\n      }\n\n      const finalAssistantMessage: Message = {\n        ...assistantMessage,\n        content: assistantMessage.content,\n        isStreaming: false,\n      };\n      onMessage?.(finalAssistantMessage);\n\n      // Save messages to storage\n      if (storageRef.current) {\n        storageRef.current.saveMessages([...messages, userMessage, finalAssistantMessage]);\n      }\n\n    } catch (error) {\n      console.error('Failed to send message:', error);\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      setError(errorMessage);\n      onError?.(error as Error);\n\n      // Remove the streaming assistant message on error\n      setMessages(messages.filter(msg => msg.id !== assistantMessage.id));\n    } finally {\n      setIsLoading(false);\n    }\n  }, [\n    messages, isLoading, addMessage, updateMessage, setMessages, onMessage,\n    onError, setError, setIsLoading, streaming,\n  ]);\n\n  /**\n   * Handle voice recording toggle\n   */\n  const handleToggleRecording = useCallback(async () => {\n    if (!voiceConnectionRef.current) return;\n\n    try {\n      if (voiceState.isRecording) {\n        await voiceConnectionRef.current.stopRecording();\n        onVoiceEnd?.();\n      } else {\n        await voiceConnectionRef.current.startRecording();\n        onVoiceStart?.();\n      }\n    } catch (error) {\n      console.error('Failed to toggle recording:', error);\n      const errorMessage = error instanceof Error ? error.message : 'Voice recording failed';\n      setError(errorMessage);\n      onError?.(error as Error);\n    }\n  }, [voiceState.isRecording, onVoiceStart, onVoiceEnd, onError, setError]);\n\n  /**\n   * Handle alert acknowledgment\n   */\n  const handleAlertAcknowledge = useCallback((alertId: string) => {\n    updateAlert(alertId, { acknowledged: true });\n\n    if (storageRef.current) {\n      const currentAlerts = [...alerts];\n      const updatedAlerts = currentAlerts.map(alert =>\n        alert.id === alertId ? { ...alert, acknowledged: true } : alert\n      );\n      storageRef.current.saveAlerts(updatedAlerts);\n    }\n  }, [alerts, updateAlert]);\n\n  /**\n   * Handle alert dismissal\n   */\n  const handleAlertDismiss = useCallback((alertId: string) => {\n    removeAlert(alertId);\n\n    if (storageRef.current) {\n      const updatedAlerts = alerts.filter(alert => alert.id !== alertId);\n      storageRef.current.saveAlerts(updatedAlerts);\n    }\n  }, [alerts, removeAlert]);\n\n  /**\n   * Handle theme changes\n   */\n  useEffect(() => {\n    // Only run on client-side\n    if (typeof window === 'undefined') return;\n\n    const resolvedTheme = typeof theme === 'string'\n      ? { mode: theme } as Theme\n      : theme;\n\n    setCurrentTheme(resolvedTheme);\n\n    // Apply theme to document with SSR safety\n    const isDark = resolvedTheme.mode === 'dark' ||\n      (resolvedTheme.mode === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches);\n\n    if (isDark) {\n      document.documentElement.classList.add('dark');\n    } else {\n      document.documentElement.classList.remove('dark');\n    }\n\n    // Apply custom CSS with SSR safety\n    if (resolvedTheme.customCSS) {\n      const existingStyle = document.getElementById('jodex-custom-theme');\n      if (existingStyle) {\n        existingStyle.remove();\n      }\n\n      const style = document.createElement('style');\n      style.id = 'jodex-custom-theme';\n      style.textContent = resolvedTheme.customCSS;\n      document.head.appendChild(style);\n    }\n\n    // Cleanup function\n    return () => {\n      // Remove custom CSS on cleanup\n      const customStyle = document.getElementById('jodex-custom-theme');\n      if (customStyle) {\n        customStyle.remove();\n      }\n    };\n  }, [theme]);\n\n  /**\n   * Load voice dependencies dynamically\n   */\n  useEffect(() => {\n    if (voiceEnabled && typeof window !== 'undefined') {\n      loadVoiceDependencies()\n        .then((dependencies) => {\n          setVoiceDependenciesLoaded(dependencies.motion);\n        })\n        .catch((error) => {\n          console.warn('Failed to load voice dependencies:', error);\n        });\n    }\n  }, [voiceEnabled]);\n\n  /**\n   * Initialize component on mount\n   */\n  useEffect(() => {\n    initialize();\n\n    return () => {\n      // Cleanup on unmount\n      voiceConnectionRef.current?.disconnect();\n      isInitializedRef.current = false;\n    };\n  }, [initialize]);\n\n  /**\n   * Render the component based on position\n   */\n  const renderChatInterface = () => {\n    if (isCollapsed) {\n      return (\n        <motion.div\n          className={`jodex-collapsed jodex-position-${position}`}\n          onClick={() => setIsCollapsed(false)}\n          whileHover={{ scale: 1.05 }}\n          whileTap={{ scale: 0.95 }}\n        >\n          {logo ? (\n            <img src={logo} alt=\"Jodex AI\" className=\"w-6 h-6\" />\n          ) : (\n            <span className=\"text-lg font-bold\">JD</span>\n          )}\n        </motion.div>\n      );\n    }\n\n    return (\n      <motion.div\n        className={`jodex-chat-container jodex-position-${position} ${\n          position === 'fullscreen' ? 'w-full h-full' : ''\n        }`}\n        style={{\n          width: position !== 'fullscreen' ? width : undefined,\n          height: position !== 'fullscreen' ? height : undefined,\n        }}\n        initial={animations ? { scale: 0.8, opacity: 0 } : undefined}\n        animate={animations ? { scale: 1, opacity: 1 } : undefined}\n        exit={animations ? { scale: 0.8, opacity: 0 } : undefined}\n        transition={{ duration: 0.2 }}\n      >\n        <ChatInterface\n          messages={messages}\n          isLoading={isLoading}\n          onSendMessage={handleSendMessage}\n          onCollapse={() => setIsCollapsed(true)}\n          config={config}\n          showHeader={showHeader}\n          showFooter={showFooter}\n          showTimestamps={showTimestamps}\n          voiceEnabled={voiceEnabled}\n        />\n\n        {voiceEnabled && voiceDependenciesLoaded && (\n          <NoSSR fallback={null}>\n            <VoiceInterface\n              voiceState={voiceState}\n              onToggleRecording={handleToggleRecording}\n              config={config}\n              browserCompatibility={browserCompatibility}\n            />\n          </NoSSR>\n        )}\n\n        {enableAlerts && alerts.length > 0 && (\n          <AlertPanel\n            alerts={alerts}\n            onAcknowledge={handleAlertAcknowledge}\n            onDismiss={handleAlertDismiss}\n          />\n        )}\n      </motion.div>\n    );\n  };\n\n  return (\n    <AnimatePresence>\n      <div className=\"jodex-container\">\n        <ErrorBoundary\n          onError={(error, errorInfo) => {\n            console.error('Jodex AI Error:', error, errorInfo);\n            onError?.(error);\n          }}\n          showRetry={!debugMode}\n        >\n          {renderChatInterface()}\n\n          {error && debugMode && (\n            <div className=\"fixed bottom-4 left-4 bg-red-500 text-white p-4 rounded-lg shadow-lg max-w-sm z-[60]\">\n              <strong>Error:</strong> {error}\n            </div>\n          )}\n        </ErrorBoundary>\n      </div>\n    </AnimatePresence>\n  );\n};\n\n// Display name for debugging\nJodexAI.displayName = 'JodexAI';"]}